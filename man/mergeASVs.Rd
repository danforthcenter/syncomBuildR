% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mergeASVs.R
\name{mergeASVs}
\alias{mergeASVs}
\title{Function combine ASV tables that have been aligned with blastASVs}
\usage{
mergeASVs(
  blast,
  asv,
  taxa = NULL,
  shared_meta = NULL,
  check_taxa = TRUE,
  min_pident = 99.5,
  cores = getOption("mc.cores", 1)
)
}
\arguments{
\item{blast}{A dataframe as returned by \link{blastASVs}.}

\item{asv}{A list of two ASV tables.}

\item{taxa}{Optional taxonomy information in the form returned by dada2 for both experiments.
Defaults to NULL.}

\item{shared_meta}{Optional column names present in both ASV tables that you wish to include in the
new ASV table output.}

\item{check_taxa}{Logical, should taxa be checked for overlap and the results included in the link
part of the output? Note even if this is false you will be able to tell if the taxa are misaligned
in the taxa part of the output if taxa is non NULL,}

\item{min_pident}{Minimum pident match returned by blastASVs to merge. Defaults to 99.}

\item{cores}{Optionally a number of cores to run in parallel using parallel::mclapply. Defaults to 1
if the "mc.cores" option is unset}
}
\value{
A named list of dataframes including "asv" and "links", optionally with "taxa"
}
\description{
Function combine ASV tables that have been aligned with blastASVs
}
\examples{

if ("rBLAST" \%in\% installed.packages() && rBLAST::has_blast()) {
  seqs1 <- list(
    ASV9 = paste0(
      "GTGCCAGCAGCCGCGGTAATACGAAGGGGGCTAGCGTTGCTCGGAATCACTGGGCGT",
      "AAAGGGTGCGTAGGCGGGTCTTTAAGTCAGGGGTGAAATCCTGGAGCTCAACTCCAGAACTGCCT",
      "TTGATACTGAAGATCTTGAGTTCGGGAGAGGTGAGTGGAACTGCGAGTGTAGAGGTGAAATTCGTA",
      "GATATTCGCAAGAACACCAGTGGCGAAGGCGGCTCACTGGCCCGATACTGACGCTGAGGCACGAAAGCGT",
      "GGGGAGCAAACAGGATTAGATACCCTGGTAGTCCACGCCGTAAACGATGAATGCCAGCCGTTAGTGGGTT",
      "TACTCACTAGTGGCGCAGCTAACGCTTTAAGCATTCCGCCTGGGGAGTACGGTCGCAAGATTAAAACTCAAATGAATTGACGG"
    ),
    ASV10 = paste0(
      "GTGCCAGCCGCCGCGGTAATACGAAGGGGGCTAGCGTTGCTCGGAATCACTGGGCGTAAAGGGTGCGTAGGCGGGTCT",
      "TTAAGTCAGGGGTGAAATCCTGGAGCTCAACTCCAGAACTGCCTTTGATACTGAAGATCTTGAGTTCGGGAGAGGTGAGTGGAACTG",
      "CGAGTGTAGAGGTGAAATTCGTAGATATTCGCAAGAACACCAGTGGCGAAGGCGGCTCACTGGCCCGATACTGACGCTGAGGCACGAA",
      "AGCGTGGGGAGCAAACAGGATTAGATACCCTGGTAGTCCACGCCGTAAACGATGAATGCCAGCCGTTAGTGGGTTTACTCACTAGTGGCG",
      "CAGCTAACGCTTTAAGCATTCCGCCTGGGGAGTACGGTCGCAAGATTAAAACTCAAATGAATTGACGG"
    )
  )
  seqs2 <- list(
    ASV1 = paste0(
      "GTGCCAGCAGCCGCGGTAATACAGAGGGTGCAAGCGTTAATCGGAATTACTGGGCGTAAAGCGCGCGTAGGTGGTTTGTTAAGT",
      "TGGATGTGAAATCCCCGGGCTCAACCTGGGAACTGCATTCAAAACTGACAAGCTAGAGTATGGTAGAGGGTGGTGGAATTTCCTGTGTAGC",
      "GGTGAAATGCGTAGATATAGGAAGGAACACCAGTGGCGAAGGCGACCACCTGGACTGATACTGACACTGAGGTGCGAAAGCGTGGGGAGCA",
      "AACAGGATTAGATACCCTGGTAGTCCACGCCGTAAACGATGTCAACTAGCCGTTGGGAGCCTTGAGCTCTTAGTGGCGCAGCTAACGCATT",
      "AAGTTGACCGCCTGGGGAGTACGGCCGCAAGGTTAAAACTCAAATGAATTGACGG"
    ),
    ASV2 = paste0(
      "GTGCCAGCCGCCGCGGTAATACAGAGGGTGCAAGCGTTAATCGGAATTACTGGGCGTAAAGCGCGCGTAGGTGGTTTGTTAA",
      "GTTGGATGTGAAATCCCCGGGCTCAACCTGGGAACTGCATTCAAAACTGACAAGCTAGAGTATGGTAGAGGGTGGTGGAATTTCCTGTGTAG",
      "CGGTGAAATGCGTAGATATAGGAAGGAACACCAGTGGCGAAGGCGACCACCTGGACTGATACTGACACTGAGGTGCGAAAGCGTGGGGAGC",
      "AAACAGGATTAGATACCCTGGTAGTCCACGCCGTAAACGATGTCAACTAGCCGTTGGGAGCCTTGAGCTCTTAGTGGCGCAGCTAACGC",
      "ATTAAGTTGACCGCCTGGGGAGTACGGCCGCAAGGTTAAAACTCAAATGAATTGACGG"
    )
  )
  blast <- blastASVs(seqs1, seqs2, cutoff = 0)
  asv1 <- data.frame("ASV9" = c(1:5), "ASV10" = c(6:10))
  asv2 <- data.frame("ASV1" = c(1:5), "ASV2" = c(6:10))
  asv_table_list <- list(asv1, asv2)
  ex <- mergeASVs(blast, asv_table_list, min_pident = 80)
}

}
\keyword{ASVs}
\keyword{combine}
